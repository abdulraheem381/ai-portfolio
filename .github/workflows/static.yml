name: Deploy to GitHub Pages

on:
  push:
    branches: ["main"]        # Change to "master" if that's your default branch
  workflow_dispatch:         # Allows manual trigger

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: pages
  cancel-in-progress: false

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      # 1. Checkout code
      - name: Checkout
        uses: actions/checkout@v4

      # 2. Setup Node (change version if needed)
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'          # or 18, 22, etc.
          cache: 'npm'                # or 'yarn' or 'pnpm'

      # 3. Install dependencies
      - name: Install dependencies
        run: npm ci                     # npm ci is cleaner than npm install

      # 4. Build the site
      - name: Build
        run: npm run build              # Make sure this script exists in package.json
        env:
          # Important for SPAs (React, Vite, etc.) - set correct base path
          BASE_PATH: /${{ github.event.repository.name }}/

      # 5. (Optional but recommended) Add .nojekyll for SPAs or if you have files starting with _
      - name: Add .nojekyll
        run: touch ./dist/.nojekyll     # Change ./dist to your build folder if different

      # 6. Deploy to GitHub Pages
      - name: Deploy üöÄ
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./dist            # ‚ö†Ô∏è CHANGE THIS if your build folder is different
          # Common alternatives:
          # - Vite/React ‚Üí ./dist
          # - Next.js   ‚Üí ./out       (for `next export`)
          # - Nuxt 3    ‚Üí ./dist
          # - Astro     ‚Üí ./dist
          # - Hugo      ‚Üí ./public
          # - Jekyll    ‚Üí ./_site
          # - Plain HTML ‚Üí ./ (root)
          force_orphan: true
          allow_empty_commit: false